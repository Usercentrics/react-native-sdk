#!/bin/bash

echo "ğŸ§¹ Limpando caches do Xcode e do React Native..."

# 1ï¸âƒ£ Limpa DerivedData
echo "ğŸ“‚ Limpando DerivedData..."
rm -rf ~/Library/Developer/Xcode/DerivedData/*

# 2ï¸âƒ£ Limpa build do projeto iOS
echo "ğŸ—ï¸ Limpando pastas de build do projeto iOS..."
cd ios
# Remove manualmente a pasta build primeiro
rm -rf build
# Tenta limpar com xcodebuild, mas nÃ£o falha se der erro
xcodebuild clean || echo "âš ï¸  xcodebuild clean falhou, continuando..."
cd ..

# 3ï¸âƒ£ Limpa cache do Cocoapods
echo "ğŸ¥£ Limpando cache do Cocoapods..."
if [ -f "ios/Podfile" ]; then
  cd ios
  pod cache clean --all
  rm -rf Pods
  rm -rf ~/Library/Caches/CocoaPods
  pod install --repo-update
  cd ..
else
  echo "âš ï¸  Podfile nÃ£o encontrado, pulando limpeza do Cocoapods"
fi

# 4ï¸âƒ£ Limpa cache do Yarn
echo "ğŸ§¶ Limpando cache do Yarn..."
yarn cache clean

# 5ï¸âƒ£ Limpa cache do Metro bundler
echo "ğŸš€ Limpando cache do Metro bundler..."
rm -rf /tmp/metro-*

echo "âœ… Todos os caches foram limpos. Agora tente reconstruir o projeto!"
